<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>AI Interview Avatar</title>

  <style>
    html,body{margin:0;height:100%;background:#f7f7f7;font-family:Arial,helvetica,sans-serif}
    #duix-container{width:100vw;height:100vh}
  </style>

  <!-- DUIX browser SDK -->
  <script src="https://cdn.guiji.ai/duix/sdk/0.2.2/duix.js"></script>
</head>
<body>
  <div id="duix-container"></div>

  <script>
    /* ---------- helpers ------------------------------------------------ */
    const getParam = k => new URLSearchParams(location.search).get(k);

    /* ---------- bootstrap --------------------------------------------- */
    (async () => {
      const sign           = getParam('sign');
      const conversationId = getParam('conversationId');

      if (!sign || !conversationId) {
        document.body.textContent = 'Missing sign or conversationId';
        return;
      }

      /**
       * 0.2.x of the DUIX browser SDK sometimes ships as an ESM bundle
       * (export‑default) and sometimes as a UMD global.
       * Grab whichever surface is actually present, then verify it really
       * has an `init()` method before proceeding.
       */
      // Grab the global DUIX object (UMD)
      const sdk = window.duix || window.DUIX;

      if (!sdk || typeof sdk.init !== 'function') {
        console.error('DUIX SDK object not found or missing init():', sdk);
        document.body.textContent = 'DUIX SDK failed to load';
        return;
      }

      try {
        await sdk.init({
          appId          : '1377185422953811968',
          appKey         : '4f3725b2-7d48-4ea7-8640-d1a11eb00f8c',
          /**  Note the correct key is *containerLabel* (two Ls)  */
          containerLabel : 'duix-container',
          sign,
          conversationId
        });
      } catch (err) {
        console.error('duix.init failed:', err);
        document.body.textContent = 'Failed to start interview';
      }
    })();
  </script>
</body>
</html>